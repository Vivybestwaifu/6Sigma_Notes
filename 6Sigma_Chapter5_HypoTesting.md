### 第五章 假设检验

#### 1. 基本原理和方法

- 概念
    * 原假设
    * 备择假设
    * 原假设和备择假设一定构成全空间

- 方法
    * 假设原假设成立
    * 观测样本计算并检验参数
    * 如果样本参数落入拒绝域则拒绝原假设选择备择假设
    * 参数未落入拒绝域只能说明没有足够证据拒绝原假设，不代表原假设一定正确

#### 2. 基本步骤

1.  建立假设
2.  选择检验统计量，确定拒绝域的形式
3.  给出检验中的显著性水平
4.  给出临界值，确定拒绝域
5.  根据样本观察值，计算检验统计量的值并进行判断
    1.  p值比较法
           - p值的物理意义是“对于此样本，拒绝原假设而会犯第一类错误的概率”
    2.  置信区间法
    3.  临界值法

#### 3. 对不同参数的检验
1.  **单正态总体 均值检验**
    1.  总体标准差已知时，直接使用
        $Z = \frac{\overline{X}-\mu}{\sigma/\sqrt{n}} \sim N(0,1)$
    2.  总体标准差未知时，使用样本标准差代替总体标准差
        $Z = \frac{\overline{X}-\mu}{S/\sqrt{n}} \sim t(n-1)$
        其中 $S= \sqrt{\frac{1}{n-1}\sum_{i=1}^{n}(X_i - \overline{X})^2}$
2.  假设检验所需验证的**前提条件**
    1.  独立性检验
    2.  正态性检验
    3.  异常值检验
        1.  设定检出异常值个数的上限
        2.  对异常值进行检验
        3.  对异常值进行处理
3.  **双正态总体 均值检验**
    1.  **前提条件**
        1.  两组样本内部相互独立，两组间也相互独立
        2.  两组样本皆来自正态分布总体
        3.  两个总体方差(或标准差)相等
    2.  双总体标准差 已知
        $Z = \frac{\overline{X}-\overline{Y}}{\sqrt{\frac{\sigma_1^2}{n}+\frac{\sigma_2^2}{m}}} \sim N(0,1)$
    3.  双总体标准差 未知 但 相等
        $Z = \frac{\overline{X}-\overline{Y}}{S_W\sqrt{\frac{1}{n}+\frac{1}{m}}} \sim t(n+m-2)$
        其中 $S_W = \sqrt{\frac{(n-1) S_X^2 + (m-1) S^2_Y}{n+m-2}}$
    4.  双总体标准差 未知 且 不知道是否相等
        只能采用近似双样本t检验
        $t = \frac{\overline{X}-\overline{Y}}{\sqrt{\frac{S_X^2}{n}+\frac{S_Y^2}{m}}}$
        其自由度取最接近下列数值v的**整数**
        $v = \frac{(\frac{S_X^2}{n} + \frac{S_Y^2}{m})^2}{\frac{(S_X^2/n)^2}{n-1}+\frac{(S_Y^2/m)^2}{m-1}}$
4.  **单正态总体 方差检验**
    1.  意义：判断总体的方差是否因某种原因发生了改变
    2.  总体标准差已知时，直接使用
        $\chi^2 = \frac{(n-1)S^2}{\sigma_0^2} \sim \chi^2(n-1)$
    3.  拒绝域
        1.  $H_1: \sigma^2 > \sigma_0^2$，拒绝域为$\chi^2 > \chi_{1-\alpha}^2(n-1)$
        2.  $H_1: \sigma^2 < \sigma_0^2$，拒绝域为$\chi^2 < \chi_{\alpha}^2(n-1)$
        3.  $H_1: \sigma^2 \not= \sigma_0^2$，拒绝域为$\chi^2 < \chi_{\frac{\alpha}{2}}^2 (n-1)$ 或 $\chi^2 > \chi_{ 1 - \frac{\alpha}{2}}^2(n-1)$
5.  **双总体 等方差检验**
    1.  意义：很多检验的前提是两批数据的方差相等，因此首先进行等方差检验
    2.  F检验
        $F = \frac{S_1^2}{S_2^2}$
        或者Levene 检验 （以中位数而非均值作为基准，适用于小样本或非正态型数据）
    3.  拒绝域
        1.  $H_1: \sigma_1^2 > \sigma_2^2$，拒绝域为$F > F_{1-\alpha}(n-1, m-1)$
        2.  $H_1: \sigma_1^2 < \sigma_2^2$，拒绝域为$F < F_{\alpha}(n-1, m-1)$
        3.  $H_1: \sigma_1^2 \not = \sigma_2^2$，拒绝域为$F > F_{1 - \frac{\alpha}{2}}(n-1, m-1)$ 或者 $F < F_{\frac{\alpha}{2}}(n-1, m-1)$

6.  **多总体 方差分析ANOVA**
    1.  基本原理： 若F值足够大，则可以判定因子是显著的。($ F > F_{1-\alpha}(df_A, df_E)$)
    2.  同时亦可得到：
        1.  第i个水平指标的均值的估计为：$\hat{\mu_i} = \bar{Y_i}$；
        2.  各组内的共同的误差方差$\sigma^2$的估计值就是$MS_E$
    3.  单因子ANOVA表
        |来源|偏差平方和(SS)|自由度(dF)|均方和(EMS)|F|
        | ----|---- | ---- | ----| ---- |
        |因子A|$SS_A$|$df_A=k-1$|$MS_A = SS_A/df_A$|$F=MS_A/MS_E$
        |误差e|$SS_E$|$df_E=n-k$|$MS_E=SS_E/df_E$|
        |总计T|$SS_T=SS_A+SS_E$|$df_T=n-1$|

        其中：
        $$
            SS_E = \sum_{i=1}^{k}\sum_{j=1}^{m}(Y_{ij}-\bar{Y_i})^2 \\
            SS_A = \sum_{i=1}^{k}m_i(\bar{Y_i}-\bar{\bar{Y}})^2 \\
            SS_T = \sum_{i=1}^{k}\sum_{j=1}^{m}(Y_{ij}-\bar{\bar{Y_i}})^2
        $$
    
    4.  单因子ANOVA多重比较方法

        |多重比较方法|比较的内容|误差率设定|
        |---|---|---|
        |Tukey|各水平均值两两比较的差异|指定整体误差率，两两个别比较误差率要大大变小|
        |Fisher|各水平均值两两比较的差异|指定两两的个别比较误差率，整体的总误差率会大大变大|
        |Dunnett|与对照组比较的差异$\mu_i-\mu_c$|指定全族的误差率，每组只与对照组相比较|
        |许氏MCB|与最佳组比较的均值差异$\mu_i-\mu_{best}$|指定全族的误差率，每组只与整体最佳组相比较|

    5.  多总体等方差检验

7.  **假设检验比较方法总结**

（其中BS=基本统计，TBL=表格，NP=非参数）
| |均值$\mu$|方差$\sigma^2$|比率$p$|中位数median|
|---|---|---|---|---|
|单总体|1. $\sigma$已知<br>BS>单样本Z检验<br> 2. $\sigma$未知<br>BS>单样本T检验|1. BS>单方差检验<br>2. BS>图形化汇总|BS>单比率检验
|双总体|
|多总体|

